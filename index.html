<!DOCTYPE html>
<html>
<head>
    <title>Shopify Store Navigator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .controls {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
        }
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s;
            flex: 1;
            max-width: 200px;
        }
        #startBtn {
            background-color: #4CAF50;
            color: white;
        }
        #startBtn:hover {
            background-color: #45a049;
        }
        #stopBtn {
            background-color: #f44336;
            color: white;
        }
        #stopBtn:hover {
            background-color: #da190b;
        }
        button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
            opacity: 0.7;
        }
        .progress {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 4px;
        }
        .progress-bar {
            height: 20px;
            background-color: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
        }
        .progress-bar-fill {
            height: 100%;
            background-color: #4CAF50;
            transition: width 0.3s ease;
        }
        .status {
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }
        #output {
            margin-top: 20px;
            padding: 15px;
            background-color: #1e1e1e;
            color: #fff;
            border-radius: 4px;
            font-family: monospace;
            height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .input-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: #333;
        }
        input[type="number"] {
            width: 120px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .input-container {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Shopify Store Navigator</h1>
        
        <div class="input-container">
            <div class="input-group">
                <label for="browserWait">Browser Wait Time (m):</label>
                <input type="number" id="browserWait" value="0" min="0">
            </div>
            
            <div class="input-group">
                <label for="pageWait">Page Wait Time (m):</label>
                <input type="number" id="pageWait" value="0" min="0">
            </div>
        </div>

        <div class="controls">
            <button id="startBtn">Start</button>
            <button id="stopBtn" disabled>Stop</button>
        </div>

        <div class="progress">
            <div class="progress-bar">
                <div class="progress-bar-fill" style="width: 0%"></div>
            </div>
            <div class="status">
                Progress: <span id="progressText">0/0</span> stores
                (<span id="successCount">0</span> succeeded, <span id="failCount">0</span> failed)
            </div>
            <div class="status">
                Current Store: <span id="currentStore">-</span>
            </div>
        </div>

        <div id="output"></div>
    </div>

    <script>
        const { ipcRenderer } = require('electron');
        
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const output = document.getElementById('output');
        const progressBar = document.querySelector('.progress-bar-fill');
        const progressText = document.getElementById('progressText');
        const successCount = document.getElementById('successCount');
        const failCount = document.getElementById('failCount');
        const currentStore = document.getElementById('currentStore');
        const browserWaitInput = document.getElementById('browserWait');
        const pageWaitInput = document.getElementById('pageWait');

        let isRunning = false;

        function updateButtons() {
            startBtn.disabled = isRunning;
            stopBtn.disabled = !isRunning;
        }

        startBtn.addEventListener('click', () => {
            const browserWait = parseInt(browserWaitInput.value) || 0;
            const pageWait = parseInt(pageWaitInput.value) || 0;
            
            isRunning = true;
            updateButtons();
            output.textContent = '';
            
            ipcRenderer.send('start-script', { browserWait, pageWait });
        });

        stopBtn.addEventListener('click', () => {
            isRunning = false;
            updateButtons();
            ipcRenderer.send('stop-script');
        });

        ipcRenderer.on('script-output', (event, data) => {
            output.textContent += data;
            output.scrollTop = output.scrollHeight;
        });

        ipcRenderer.on('script-error', (event, error) => {
            output.textContent += `\nError: ${error}`;
            output.scrollTop = output.scrollHeight;
        });

        ipcRenderer.on('progress-update', (event, data) => {
            const total = data.total;
            const succeeded = data.succeeded;
            const failed = data.failed;
            const progress = ((succeeded + failed) / total) * 100;
            
            progressBar.style.width = `${progress}%`;
            progressText.textContent = `${succeeded + failed}/${total}`;
            successCount.textContent = succeeded;
            failCount.textContent = failed;
            
            if (data.currentStore) {
                currentStore.textContent = data.currentStore;
            }
        });

        ipcRenderer.on('script-finished', (event, code) => {
            isRunning = false;
            updateButtons();
            output.textContent += `\nScript finished with code: ${code}\n`;
        });

        // Request initial store list
        ipcRenderer.send('get-stores');
        
        ipcRenderer.on('stores-loaded', (event, data) => {
            progressText.textContent = `0/${data.total}`;
            successCount.textContent = '0';
            failCount.textContent = '0';
        });
    </script>
</body>
</html> 